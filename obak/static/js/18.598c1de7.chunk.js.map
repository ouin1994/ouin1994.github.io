{"version":3,"sources":["scripts/components/login/index.js","scripts/views/login/index.js","utils/axios.js","utils/index.js"],"names":["mReg","cReg","timer","NormalLoginForm","state","codeFlag","loginFlag","toggleFlag","txt","count","handleSubmit","e","preventDefault","props","form","validateFields","err","values","axios","post","then","res","data","type","sessionStorage","token","mobile","value","history","push","console","log","handleCheckMobile","v","target","code","setState","test","handleCheckCode","start","toggle","clearInterval","computedTime","setInterval","handleSendCode","getFieldDecorator","this","onSubmit","className","Item","rules","required","message","prefix","style","color","placeholder","onChange","ref","el","onClick","disabled","htmlType","React","Component","WrappedNormalLoginForm","Form","create","name","Login","href","rel","baseURL","fail","msg","warning","destroy","success","defaults","headers","common","interceptors","request","use","config","time","loading","error","Promise","reject","response"],"mappings":"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","file":"static/js/18.598c1de7.chunk.js","sourcesContent":["import { Form, Icon, Input, Button } from 'antd';\r\nimport React from \"react\";\r\nimport { axios } from \"&\";\r\nimport \"./index.scss\";\r\nlet mReg = /^1(3|4|5|7|8|9)[0-9]{9}$/;\r\nlet cReg = /^\\d{4}$/;\r\nlet timer = null;\r\nclass NormalLoginForm extends React.Component {\r\n  state = {\r\n    codeFlag: false,\r\n    loginFlag: false,\r\n    toggleFlag: true,\r\n    txt: \"发送验证码\",\r\n    count: 60,\r\n  }\r\n  handleSubmit = e => {\r\n    e.preventDefault();\r\n    this.props.form.validateFields((err, values) => {\r\n      if (!err) {\r\n        axios.post(\"/react/checkCode\", values)\r\n          .then(res => {\r\n            if (!!res.data.type) {\r\n              sessionStorage.token = res.data.token;\r\n              sessionStorage.mobile = this.mobile.state.value;\r\n              this.props.history.push(\"/destiny\")\r\n            } else {\r\n              sessionStorage.token = \"\";\r\n              sessionStorage.mobile = \"\";\r\n            }\r\n          })\r\n        console.log('Received values of form: ', values);\r\n      }\r\n    });\r\n  };\r\n  handleCheckMobile = (v) => {\r\n    var mobile = v.target.value;\r\n    var code = this.code.state.value;\r\n    if (this.state.toggleFlag) {\r\n      this.setState({\r\n        codeFlag: mReg.test(mobile),\r\n        loginFlag: mReg.test(mobile) && cReg.test(code)\r\n      })\r\n    }\r\n  }\r\n  handleCheckCode = (v) => {\r\n    var code = v.target.value;\r\n    this.setState({\r\n      loginFlag: cReg.test(code)\r\n    })\r\n  }\r\n  start = () => {\r\n    if (this.state.count > 1) {\r\n      let count = this.state.count;\r\n      --count\r\n      this.setState({\r\n        count,\r\n        txt: `剩余 ${this.state.count} S`,\r\n        codeFlag: false,\r\n        toggle: false\r\n      })\r\n    } else {\r\n      clearInterval(timer);\r\n      timer = null;\r\n      this.setState({\r\n        count: 60,\r\n        txt: '发送验证码',\r\n        codeFlag: true,\r\n        toggle: true\r\n      })\r\n    }\r\n  }\r\n  computedTime = () => {\r\n    this.start();\r\n    timer = setInterval(this.start, 1000)\r\n  }\r\n  handleSendCode = () => {\r\n\r\n    let mobile = this.mobile.state.value;\r\n    this.computedTime()\r\n    axios.post(\"/react/sendSms\", { mobile })\r\n      .then(res => {\r\n        console.log(res)\r\n      })\r\n  }\r\n\r\n  render() {\r\n    const { getFieldDecorator } = this.props.form;\r\n    const {\r\n      codeFlag,\r\n      loginFlag,\r\n      txt\r\n    } = this.state;\r\n    return (\r\n      <Form onSubmit={this.handleSubmit} className=\"login-form\">\r\n        <Form.Item>\r\n          {getFieldDecorator('mobile', {\r\n            rules: [{ required: true, message: 'Please input your mobile!' }],\r\n          })(\r\n            <Input\r\n              prefix={<Icon type=\"phone\" style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n              placeholder=\"Mobile\"\r\n              onChange={this.handleCheckMobile}\r\n              ref={el => this.mobile = el}\r\n            />,\r\n          )}\r\n        </Form.Item>\r\n        <Form.Item>\r\n          {getFieldDecorator('code', {\r\n            rules: [{ required: true, message: 'Please input your Code!' }],\r\n          })(\r\n            <div className=\"code\">\r\n              <Input\r\n                prefix={<Icon type=\"code\" style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n                type=\"text\"\r\n                placeholder=\"Code\"\r\n                className=\"codeInput\"\r\n                ref={el => this.code = el}\r\n                onChange={this.handleCheckCode}\r\n              />\r\n              <Button type=\"danger\" onClick={this.handleSendCode} disabled={!codeFlag} className=\"login-form-button code-btn\">\r\n                {txt}\r\n              </Button>\r\n            </div>,\r\n          )}\r\n        </Form.Item>\r\n        <Form.Item>\r\n          <Button type=\"primary\" disabled={!loginFlag} htmlType=\"submit\" className=\"login-form-button submit-btn\">\r\n            Log in\r\n          </Button>\r\n        </Form.Item>\r\n      </Form>\r\n    );\r\n  }\r\n}\r\nconst WrappedNormalLoginForm = Form.create({ name: 'normal_login' })(NormalLoginForm);\r\nexport default WrappedNormalLoginForm","import React, { Component } from 'react';\r\n\r\nimport \"./index.scss\";\r\nimport WrappedNormalLoginForm from '../../components/login';\r\nclass Login extends Component {\r\n    render() {\r\n        return (\r\n            <div className='login'>\r\n                <div className='flex login-header'>\r\n                    <div className='login-header-logo'>Destiny</div>\r\n                    <div className='login-header-href'>\r\n                        <a target='_blank' href=\"https://github.com/ouin1994/ouin1994.github.io\" rel=\"noopener noreferrer\">GitHub</a>\r\n                    </div>\r\n                </div>\r\n                <div className='flex login-content'>\r\n                    <div className=\"outbox\">\r\n                        <div className=\"title\">\r\n                            <p>登录</p>\r\n                        </div>\r\n                        <div className=\"Box\">\r\n                            <WrappedNormalLoginForm\r\n                            {...this.props}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Login;","\r\nimport axios from \"axios\";\r\nimport { message } from \"antd\"\r\nconst baseURL = 'https://ook.life:1993/'\r\nlet token = \"\";\r\naxios.defaults.baseURL = baseURL;\r\naxios.defaults.headers.common['token'] = token;   // req.headers.token \r\naxios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\r\n\r\n\r\n// axios  拦截器  Interceptors\r\n// request 请求发送之前的拦截器\r\nexport function loadingToast(msg, time) {\r\n    msg = msg || \"请求中...\";\r\n    time = time || 1;\r\n    message.loading(msg, time, () => {\r\n        message.destroy();\r\n        console.log(msg);\r\n    });\r\n}\r\n\r\nexport function fail(msg) {\r\n    message.warning(msg, 1, () => {\r\n        message.destroy();\r\n        console.log(msg);\r\n    });\r\n}\r\n\r\nexport function offline(msg) {\r\n    message.error(msg, 1, () => {\r\n        message.destroy();\r\n    });\r\n}\r\n\r\nexport function success(msg) {\r\n    message.destroy();\r\n    message.success(msg, 1, () => {})\r\n}\r\n// axios  拦截器  Interceptors\r\n// request 请求发送之前的拦截器\r\naxios.interceptors.request.use(function (config) {\r\n    // 配置动画\r\n    loadingToast();\r\n    return config;\r\n}, function (error) {\r\n    // 请求失败错误提示 \r\n    offline(\"请求失败-网络异常\");\r\n    return Promise.reject(error);\r\n});\r\n\r\n\r\n\r\n// response 响应 完成 的拦截器\r\naxios.interceptors.response.use(function (response) {\r\n    console.log(response)\r\n    // if (response.data.code === \"3000\") {\r\n    //     // 跳转 登录 \r\n    // }\r\n    // type  不存在    success\r\n    // type = 0  fail\r\n    // type = 1  success \r\n    if (!!response.data.type) {\r\n        success(response.data.msg);\r\n    } else {\r\n        if (response.data.type === 0) {\r\n            fail(response.data.msg)\r\n        } else {\r\n            success(response.data.msg)\r\n        }\r\n    }\r\n\r\n\r\n    // 成功的响应\r\n    return response;\r\n}, function (error) {\r\n    // 失败的响应 \r\n    fail(\"响应失败-服务器异常\")\r\n    return Promise.reject(error);\r\n});\r\nexport { axios, baseURL }","\r\nexport { axios, baseURL } from \"./axios\";\r\n\r\nexport const commonCss = {\r\n    all: {\r\n        margin: 0,\r\n        padding: 0\r\n    },\r\n    two: {\r\n        fontSize: 15,\r\n        color: \"orange\",\r\n        width: 200,\r\n        height: 200\r\n    }\r\n\r\n}\r\n\r\n\r\nexport const commonJs = {\r\n    todo: function () {\r\n        console.log(this)   // undefined\r\n    },\r\n    doNow: function () {\r\n        console.log(this)   // 指向commonJs\r\n    }\r\n\r\n}\r\n"],"sourceRoot":""}