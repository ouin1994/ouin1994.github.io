"use strict";$(".header").load("../layout/header.html"),$("#footer").load("../layout/footer.html"),$(document).on("mouseenter",".small-box",function(){$(".show").css({display:"block"}).prev().css({display:"none"}),$(".big-box").css({display:"block"}),$(this).on("mousemove",function(o){var t=event||o,s=(t.target||t.srcElement,$(".small-box").offset()),e=s.top,i=s.left,a=$(".small-box").outerWidth()-$(".show").outerWidth(),l=$(".small-box").outerHeight()-$(".show").outerHeight(),c=($(".big-box img").outerWidth()-$(".big-box").outerWidth())/a,n=($(".big-box img").outerHeight()-$(".big-box").outerHeight())/l,d=t.pageX-$(".show").width()/2-i,r=t.pageY-$(".show").height()/2-e;d<0&&(d=0),a<d&&(d=a),r<0&&(r=0),l<r&&(r=l),$(".show").css({left:d,top:r}),$(".big-box img").css({left:-d*c,top:-r*n})})}),$(document).on("mouseleave",".small-box",function(){$(".show").css({display:"none"}).prev().css({display:"block"}),$(".big-box").css({display:"none"})}),$(document).on("click",".img-list li img",function(){$(this).css({border:"2px solid #f35356"}).parent().siblings().children().css({border:"none"}),$(".small-box img").attr({src:this.src}),$(".big-box img").attr({src:this.src})});var count=1;$(document).on("click","#add",function(){5<=++count&&(count=5),$(this).prev().val(count)}).on("click","#reduce",function(){--count<=1&&(count=1),$(this).next().val(count)});var str=location.search,id=str.split("=")[1];$.ajax({type:"get",url:"http://"+(-1<location.host.indexOf(":5500")?"localhost":location.host)+"/project/goods-detail.php",data:{id:id},dataType:"json",success:function(o){o.code;var t=o.data,s=t.goods_name,e=t.goods_price,i=t.goods_image,a=t.goods_desc,l=t.goods_images,c=JSON.parse(l);document.title=s,$(".small-box img").attr({src:i}),$(".big-box img").attr({src:i}),$(".price").html("￥"+e),$(".goods-name").html(s),$(".goods-desc").html(a);var n="";c.forEach(function(o){n+=" <li><img src="+o+' alt=""></li>'}),$(".img-list").html(n)}}),$(document).on("click","#buy-now",function(){if(getCookie("userLogin")){var o=getCookie("userLogin"),t=id,s=$(".goods-name").html(),e=$(".price").html().split("￥")[1],i=$(".goods-desc").html(),a=$(".small-box img").attr("src"),l=$(".count").val();$.ajax({type:"get",url:"http://"+(-1<location.host.indexOf(":5500")?"localhost":location.host)+"/project/detail-add.php",data:{username:o,goods_id:t,goods_name:s,goods_price:e,goods_desc:i,goods_img:a,goods_count:l},dataType:"json",success:function(){localStorage.setItem("id",id),location.href="./goods-pay.html"}})}else $(".login").trigger("click"),layui.use("layer",function(){layui.layer.msg("请先登录")})}),$(document).on("click","#join-cart",function(){if(getCookie("userLogin")){var o=getCookie("userLogin"),t=id,s=$(".goods-name").html(),e=$(".price").html().split("￥")[1],i=$(".goods-desc").html(),a=$(".small-box img").attr("src"),l=$(".count").val();$.ajax({type:"get",url:"http://"+(-1<location.host.indexOf(":5500")?"localhost":location.host)+"/project/detail-add.php",data:{username:o,goods_id:t,goods_name:s,goods_price:e,goods_desc:i,goods_img:a,goods_count:l},dataType:"json",success:function(t){console.log(t),layui.use("layer",function(){var o=layui.layer;t.data,o.msg(t.msg)})}})}else $(".login").trigger("click"),layui.use("layer",function(){layui.layer.msg("请先登录")})});